<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
	  	<!-- Declare the viewport to be the width of the device screen -->
	  	<meta name="viewport" content="width=device-width, initial-scale=1">
	  	<title>Chicago Bus and Train Tracker Display - CTA</title>
		<!-- Include Bootstrap library -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<!-- Include jQuery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<!-- CSS Stylesheet -->
		<link rel="stylesheet" type="text/css" href="css/mystyle.css">
	</head>

	<body>
		<!-- All Content must be inside this Div (Container-Fluid) -->

		<div class="container-fluid">
			<!-- Row 0 - Header Row -->
			<div class="row spacer">
				<!-- SPCA Logo -->
				<div class="col-lg-6 col-md-6 col-sm-6 splogo">
					<h1>SPCA Logo Placeholder</h1>
				</div>
				<!-- Show time via JS and justify right -->
				<div class="col-lg-6 col-md-6 col-sm-6">
					<h1 id="clockField" class="text-right"></h1>
				</div>
			</div>


			<!-- Row 1 - Bus and Train Names 1 -->
			<div class="row">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<h1 class="text-center station-names">Sheridan and Rosemont [NB]</h1>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<h1 class="text-center station-names">Loyola Station</h1>
				</div>
			</div>

			<!-- Row 2 - Bus and Train 1 Arrival Info 1 -->
			<div class="row left-padding">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row bus-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busNameOne" class="bottom-margin">Bus 151</h1>
							<h3 id="busIDOne" class="top-margin">ID: 0515</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busArrOne">2 MIN</h1>
						</div>
					</div>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row train-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainNameOne" class="bottom-margin">Red Line</h1>
							<h3 id="trainIDOne" class="top-margin">Train # 1515</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainArrOne">5 MIN</h1>
						</div>
					</div>
				</div>
			</div>
		
			<!-- Row 3 - Bus and Train 1 Arrival Info 2 -->
			<div class="row left-padding">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row bus-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busNameTwo" class="bottom-margin">Bus 161</h1>
							<h3 id="busIDTwo" class="top-margin">ID: 0212</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busArrTwo">8 MIN</h1>
						</div>
					</div>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row train-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainNameTwo" class="bottom-margin">Green Line</h1>
							<h3 id="trainIDTwo" class="top-margin">Train # 1215</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainArrTwo">12 MIN</h1>
						</div>
					</div>
				</div>
			</div>

			<!-- Row 4 - Bus and Train Names 2 -->
			<div class="row">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<h1 class="text-center station-names">Sheridan and Rosemont [SB]</h1>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<h1 class="text-center station-names">Granville Station</h1>
				</div>
			</div>

			<!-- Row 5 - Bus and Train 2 Arrival Info 1 -->
			<div class="row left-padding">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row bus-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busNameThree" class="bottom-margin">Bus 225</h1>
							<h3 id="busIDThree" class="top-margin">ID: 9999</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busArrThree">22 MIN</h1>
						</div>
					</div>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row train-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainNameThree" class="bottom-margin">Yellow Line</h1>
							<h3 id="trainIDThree" class="top-margin">Train # 9150</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainArrThree">55 MIN</h1>
						</div>
					</div>
				</div>
			</div>
		
			<!-- Row 3 - Bus and Train 2 Arrival Info 2 -->
			<div class="row left-padding">
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row bus-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busNameFour" class="bottom-margin">Bus 520</h1>
							<h3 id="busIDFour" class="top-margin">ID: 5464</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="busArrFour">88 MIN</h1>
						</div>
					</div>
				</div>
				<div class="col-lg-6 col-md-6 col-sm-6">
					<div class="row train-rows">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainNameFour" class="bottom-margin">Blue Line</h1>
							<h3 id="trainIDFour" class="top-margin">Train # 612</h3>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<h1 id="trainArrFour">ARRIVING</h1>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript">
			// Show time on screen (in ID clockField)
			var d = new Date();
			var t = d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
			document.getElementById("clockField").innerHTML=t;

			// jQuery Request to access and display CTA BUS API data (MUST use proxy!)
			// due to CORS restrictions.
			var busBaseURL = '/bustime/api/v2';
			var busRequestPredictions = '/getpredictions?';
			var busApiKey = 'key=' + '';
			var busStopIDNB = '&stpid=' + '1199';
			var busStopIDSB = '&stpid=' + '1032';
			var busFormat = '&format=' + 'json';
			var busPredictionURLNB = busBaseURL+busRequestPredictions+busApiKey+busStopIDNB+busFormat;
			var busPredictionURLSB = busBaseURL+busRequestPredictions+busApiKey+busStopIDSB+busFormat;

			$(document).ready(function(){
				$.getJSON(busPredictionURLNB, function(data){
					if (data["bustime-response"].hasOwnProperty("error")) {
						console.log("BR has error " + data["bustime-response"].error[0].msg);
					}
					else if (data["bustime-response"].hasOwnProperty("prd")) {
						if (data["bustime-response"].prd.length > 1) {
							console.log("Length of BR is greater than 1!");
							console.log(data["bustime-response"].prd.length);
							var busName1 = data["bustime-response"].prd[0].rt;
							var busID1 = data["bustime-response"].prd[0].vid;
							var busArr1 = data["bustime-response"].prd[0].prdctdn;
							var busName2 = data["bustime-response"].prd[1].rt;
							var busID2 = data["bustime-response"].prd[1].vid;
							var busArr2 = data["bustime-response"].prd[1].prdctdn;

							$("#busNameOne").html(busName1);
							$("#busIDOne").html(busID1);
							$("#busArrOne").html(busArr1);
							$("#busNameTwo").html(busName2);
							$("#busIDTwo").html(busID2);
							$("#busArrTwo").html(busArr2);
						}
						else if (data["bustime-response"].prd.length == 1) {
							console.log("Length of BR is exactly one!");
							console.log(data["bustime-response"].prd.length);
							var busName1 = data["bustime-response"].prd[0].rt;
							var busID1 = data["bustime-response"].prd[0].vid;
							var busArr1 = data["bustime-response"].prd[0].prdctdn;

							$("#busNameOne").html(busName1);
							$("#busIDOne").html(busID1);
							$("#busArrOne").html(busArr1);
						}
						else {
							console.log("Uh... Length is neither greater nor equal to 1!");
							console.log(data["bustime-response"].prd.length);
						}
					}
					else {
						console.log("Uh.... neither Prd nor Err!");
					}

				});
				$.getJSON(busPredictionURLSB, function(data){
					if (data["bustime-response"].hasOwnProperty("error")) {
						console.log("BR has error " + data["bustime-response"].error[0].msg);
					}
					else if (data["bustime-response"].hasOwnProperty("prd")) {
						if (data["bustime-response"].prd.length > 1) {
							console.log("Length of BR is greater than 1!");
							console.log(data["bustime-response"].prd.length);
							var busName3 = data["bustime-response"].prd[0].rt;
							var busID3 = data["bustime-response"].prd[0].vid;
							var busArr3 = data["bustime-response"].prd[0].prdctdn;
							var busName4 = data["bustime-response"].prd[1].rt;
							var busID4 = data["bustime-response"].prd[1].vid;
							var busArr4 = data["bustime-response"].prd[1].prdctdn;

							$("#busNameThree").html(busName3);
							$("#busIDThree").html(busID3);
							$("#busArrThree").html(busArr3);
							$("#busNameFour").html(busName4);
							$("#busIDFour").html(busID4);
							$("#busArrFour").html(busArr4);
						}
						else if (data["bustime-response"].prd.length == 1) {
							console.log("Length of BR is exactly one!");
							console.log(data["bustime-response"].prd.length);
							var busName3 = data["bustime-response"].prd[0].rt;
							var busID3 = data["bustime-response"].prd[0].vid;
							var busArr3 = data["bustime-response"].prd[0].prdctdn;

							$("#busNameThree").html(busName3);
							$("#busIDThree").html(busID3);
							$("#busArrThree").html(busArr3);
						}
						else {
							console.log("Uh... Length is neither greater nor equal to 1!");
							console.log(data["bustime-response"].prd.length);
						}
					}
					else {
						console.log("Uh.... neither Prd nor Err!");
					}
				});
			});

		</script>
	</body>
</html>
